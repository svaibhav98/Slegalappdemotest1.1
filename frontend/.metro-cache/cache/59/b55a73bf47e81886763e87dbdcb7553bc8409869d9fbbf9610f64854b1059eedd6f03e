{"dependencies":[{"name":"./load-balancer","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":20,"column":24,"index":744},"end":{"line":20,"column":50,"index":770}}],"key":"uOBAJTyNQHYWLk8tq5Ek7vETkD0=","exportNames":["*"],"imports":1}},{"name":"./connectivity-state","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":21,"column":29,"index":801},"end":{"line":21,"column":60,"index":832}}],"key":"jyxLDTe7V7Ou6ov9nXyoEe1g9Sg=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function(g,r,i,a,m,e,d){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.ChildLoadBalancerHandler=void 0;const t=r(d[0]),n=r(d[1]);e.ChildLoadBalancerHandler=class{constructor(t){this.channelControlHelper=t,this.currentChild=null,this.pendingChild=null,this.latestConfig=null,this.ChildPolicyHelper=class{constructor(t){this.parent=t,this.child=null}createSubchannel(t,n){return this.parent.channelControlHelper.createSubchannel(t,n)}updateState(t,l){var h;if(this.calledByPendingChild()){if(t===n.ConnectivityState.CONNECTING)return;null===(h=this.parent.currentChild)||void 0===h||h.destroy(),this.parent.currentChild=this.parent.pendingChild,this.parent.pendingChild=null}else if(!this.calledByCurrentChild())return;this.parent.channelControlHelper.updateState(t,l)}requestReresolution(){var t;const n=null!==(t=this.parent.pendingChild)&&void 0!==t?t:this.parent.currentChild;this.child===n&&this.parent.channelControlHelper.requestReresolution()}setChild(t){this.child=t}addChannelzChild(t){this.parent.channelControlHelper.addChannelzChild(t)}removeChannelzChild(t){this.parent.channelControlHelper.removeChannelzChild(t)}calledByPendingChild(){return this.child===this.parent.pendingChild}calledByCurrentChild(){return this.child===this.parent.currentChild}}}configUpdateRequiresNewPolicyInstance(t,n){return t.getLoadBalancerName()!==n.getLoadBalancerName()}updateAddressList(n,l,h){let s;if(null===this.currentChild||null===this.latestConfig||this.configUpdateRequiresNewPolicyInstance(this.latestConfig,l)){const n=new this.ChildPolicyHelper(this),h=(0,t.createLoadBalancer)(l,n);n.setChild(h),null===this.currentChild?(this.currentChild=h,s=this.currentChild):(this.pendingChild&&this.pendingChild.destroy(),this.pendingChild=h,s=this.pendingChild)}else s=null===this.pendingChild?this.currentChild:this.pendingChild;this.latestConfig=l,s.updateAddressList(n,l,h)}exitIdle(){this.currentChild&&(this.currentChild.exitIdle(),this.pendingChild&&this.pendingChild.exitIdle())}resetBackoff(){this.currentChild&&(this.currentChild.resetBackoff(),this.pendingChild&&this.pendingChild.resetBackoff())}destroy(){this.currentChild&&(this.currentChild.destroy(),this.currentChild=null),this.pendingChild&&(this.pendingChild.destroy(),this.pendingChild=null)}getTypeName(){return\"child_load_balancer_helper\"}}});","lineCount":1,"map":[[1,28,1,0],[1,41,18,0,"Object"],[1,48,18,7,"defineProperty"],[1,63,18,22,"exports"],[1,65,18,31],[1,78,18,45],[1,79,18,47,"value"],[1,86,18,54],[1,90,19,0,"exports"],[1,92,19,8,"ChildLoadBalancerHandler"],[1,122,19,32,"undefined"],[1,124,20,0],[1,130,20,6,"load_balancer_1"],[1,132,20,24,"require"],[1,134,20,31,"d"],[1,136,20,31],[1,140,21,6,"connectivity_state_1"],[1,142,21,29,"require"],[1,144,21,36,"d"],[1,146,21,36],[1,150,150,0,"exports"],[1,152,150,8,"ChildLoadBalancerHandler"],[1,177,23,0],[1,183,24,4,"constructor"],[1,195,24,16,"channelControlHelper"],[1,198,25,8,"this"],[1,203,25,13,"channelControlHelper"],[1,224,25,36,"channelControlHelper"],[1,226,26,8,"this"],[1,231,26,13,"currentChild"],[1,244,26,28],[1,249,27,8,"this"],[1,254,27,13,"pendingChild"],[1,267,27,28],[1,272,28,8,"this"],[1,277,28,13,"latestConfig"],[1,290,28,28],[1,295,29,8,"this"],[1,300,29,13,"ChildPolicyHelper"],[1,318,29,33],[1,324,30,12,"constructor"],[1,336,30,24,"parent"],[1,339,31,16,"this"],[1,344,31,21,"parent"],[1,351,31,30,"parent"],[1,353,32,16,"this"],[1,358,32,21,"child"],[1,364,32,29],[1,368,33,12],[1,369,34,12,"createSubchannel"],[1,386,34,29,"subchannelAddress"],[1,388,34,48,"subchannelArgs"],[1,391,35,16],[1,398,35,23,"this"],[1,403,35,28,"parent"],[1,410,35,35,"channelControlHelper"],[1,431,35,56,"createSubchannel"],[1,448,35,73,"subchannelAddress"],[1,450,35,92,"subchannelArgs"],[1,452,36,12],[1,453,37,12,"updateState"],[1,465,37,24,"connectivityState"],[1,467,37,43,"picker"],[1,470,38,16],[1,474,38,20,"_a"],[1,476,39,16],[1,479,39,20,"this"],[1,484,39,25,"calledByPendingChild"],[1,507,39,49],[1,508,40,20],[1,511,40,24,"connectivityState"],[1,515,40,46,"connectivity_state_1"],[1,517,40,67,"ConnectivityState"],[1,535,40,85,"CONNECTING"],[1,546,41,24],[1,553,43,56],[1,561,43,21,"_a"],[1,563,43,26,"this"],[1,568,43,31,"parent"],[1,575,43,38,"currentChild"],[1,595,43,66,"undefined"],[1,599,43,64,"_a"],[1,602,43,89,"_a"],[1,604,43,92,"destroy"],[1,614,44,20,"this"],[1,619,44,25,"parent"],[1,626,44,32,"currentChild"],[1,639,44,47,"this"],[1,644,44,52,"parent"],[1,651,44,59,"pendingChild"],[1,664,45,20,"this"],[1,669,45,25,"parent"],[1,676,45,32,"pendingChild"],[1,689,45,47],[1,693,46,16],[1,699,47,21],[1,703,47,26,"this"],[1,708,47,31,"calledByCurrentChild"],[1,731,48,20],[1,738,50,16,"this"],[1,743,50,21,"parent"],[1,750,50,28,"channelControlHelper"],[1,771,50,49,"updateState"],[1,783,50,61,"connectivityState"],[1,785,50,80,"picker"],[1,787,51,12],[1,788,52,12,"requestReresolution"],[1,810,53,16],[1,814,53,20,"_a"],[1,816,54,16],[1,822,54,22,"latestChild"],[1,824,54,72],[1,832,54,37,"_a"],[1,834,54,42,"this"],[1,839,54,47,"parent"],[1,846,54,54,"pendingChild"],[1,866,54,82,"undefined"],[1,870,54,80,"_a"],[1,872,54,96,"_a"],[1,874,54,101,"this"],[1,879,54,106,"parent"],[1,886,54,113,"currentChild"],[1,899,55,20,"this"],[1,904,55,25,"child"],[1,912,55,35,"latestChild"],[1,915,56,20,"this"],[1,920,56,25,"parent"],[1,927,56,32,"channelControlHelper"],[1,948,56,53,"requestReresolution"],[1,969,58,12],[1,970,59,12,"setChild"],[1,979,59,21,"newChild"],[1,982,60,16,"this"],[1,987,60,21,"child"],[1,993,60,29,"newChild"],[1,994,61,12],[1,995,62,12,"addChannelzChild"],[1,1012,62,29,"child"],[1,1015,63,16,"this"],[1,1020,63,21,"parent"],[1,1027,63,28,"channelControlHelper"],[1,1048,63,49,"addChannelzChild"],[1,1065,63,66,"child"],[1,1067,64,12],[1,1068,65,12,"removeChannelzChild"],[1,1088,65,32,"child"],[1,1091,66,16,"this"],[1,1096,66,21,"parent"],[1,1103,66,28,"channelControlHelper"],[1,1124,66,49,"removeChannelzChild"],[1,1144,66,69,"child"],[1,1146,67,12],[1,1147,68,12,"calledByPendingChild"],[1,1170,69,16],[1,1177,69,23,"this"],[1,1182,69,28,"child"],[1,1190,69,38,"this"],[1,1195,69,43,"parent"],[1,1202,69,50,"pendingChild"],[1,1214,70,12],[1,1215,71,12,"calledByCurrentChild"],[1,1238,72,16],[1,1245,72,23,"this"],[1,1250,72,28,"child"],[1,1258,72,38,"this"],[1,1263,72,43,"parent"],[1,1270,72,50,"currentChild"],[1,1282,73,12],[1,1284,75,4],[1,1285,76,4,"configUpdateRequiresNewPolicyInstance"],[1,1323,76,42,"oldConfig"],[1,1325,76,53,"newConfig"],[1,1328,77,8],[1,1335,77,15,"oldConfig"],[1,1337,77,25,"getLoadBalancerName"],[1,1361,77,51,"newConfig"],[1,1363,77,61,"getLoadBalancerName"],[1,1384,78,4],[1,1385,85,4,"updateAddressList"],[1,1403,85,22,"addressList"],[1,1405,85,35,"lbConfig"],[1,1407,85,45,"attributes"],[1,1410,86,8],[1,1414,86,12,"childToUpdate"],[1,1416,87,8],[1,1419,87,34],[1,1426,87,12,"this"],[1,1431,87,17,"currentChild"],[1,1445,88,34],[1,1452,88,12,"this"],[1,1457,88,17,"latestConfig"],[1,1471,89,12,"this"],[1,1476,89,17,"configUpdateRequiresNewPolicyInstance"],[1,1514,89,55,"this"],[1,1519,89,60,"latestConfig"],[1,1532,89,74,"lbConfig"],[1,1535,89,85],[1,1536,90,12],[1,1542,90,18,"newHelper"],[1,1544,90,30],[1,1548,90,34,"this"],[1,1553,90,39,"ChildPolicyHelper"],[1,1571,90,57,"this"],[1,1577,91,18,"newChild"],[1,1580,91,29],[1,1582,91,33,"load_balancer_1"],[1,1584,91,49,"createLoadBalancer"],[1,1604,91,69,"lbConfig"],[1,1606,91,79,"newHelper"],[1,1609,92,12,"newHelper"],[1,1611,92,22,"setChild"],[1,1620,92,31,"newChild"],[1,1623,93,38],[1,1630,93,16,"this"],[1,1635,93,21,"currentChild"],[1,1649,94,16,"this"],[1,1654,94,21,"currentChild"],[1,1667,94,36,"newChild"],[1,1669,95,16,"childToUpdate"],[1,1671,95,32,"this"],[1,1676,95,37,"currentChild"],[1,1691,98,20,"this"],[1,1696,98,25,"pendingChild"],[1,1710,99,20,"this"],[1,1715,99,25,"pendingChild"],[1,1728,99,38,"destroy"],[1,1738,101,16,"this"],[1,1743,101,21,"pendingChild"],[1,1756,101,36,"newChild"],[1,1758,102,16,"childToUpdate"],[1,1760,102,32,"this"],[1,1765,102,37,"pendingChild"],[1,1778,104,8],[1,1784,107,16,"childToUpdate"],[1,1786,106,38],[1,1793,106,16,"this"],[1,1798,106,21,"pendingChild"],[1,1811,107,32,"this"],[1,1816,107,37,"currentChild"],[1,1829,110,32,"this"],[1,1834,110,37,"pendingChild"],[1,1847,113,8,"this"],[1,1852,113,13,"latestConfig"],[1,1865,113,28,"lbConfig"],[1,1867,114,8,"childToUpdate"],[1,1869,114,22,"updateAddressList"],[1,1887,114,40,"addressList"],[1,1889,114,53,"lbConfig"],[1,1891,114,63,"attributes"],[1,1893,115,4],[1,1894,116,4,"exitIdle"],[1,1905,117,12,"this"],[1,1910,117,17,"currentChild"],[1,1925,118,12,"this"],[1,1930,118,17,"currentChild"],[1,1943,118,30,"exitIdle"],[1,1954,119,16,"this"],[1,1959,119,21,"pendingChild"],[1,1973,120,16,"this"],[1,1978,120,21,"pendingChild"],[1,1991,120,34,"exitIdle"],[1,2002,123,4],[1,2003,124,4,"resetBackoff"],[1,2018,125,12,"this"],[1,2023,125,17,"currentChild"],[1,2038,126,12,"this"],[1,2043,126,17,"currentChild"],[1,2056,126,30,"resetBackoff"],[1,2071,127,16,"this"],[1,2076,127,21,"pendingChild"],[1,2090,128,16,"this"],[1,2095,128,21,"pendingChild"],[1,2108,128,34,"resetBackoff"],[1,2123,131,4],[1,2124,132,4,"destroy"],[1,2134,137,12,"this"],[1,2139,137,17,"currentChild"],[1,2154,138,12,"this"],[1,2159,138,17,"currentChild"],[1,2172,138,30,"destroy"],[1,2182,139,12,"this"],[1,2187,139,17,"currentChild"],[1,2200,139,32],[1,2206,141,12,"this"],[1,2211,141,17,"pendingChild"],[1,2226,142,12,"this"],[1,2231,142,17,"pendingChild"],[1,2244,142,30,"destroy"],[1,2254,143,12,"this"],[1,2259,143,17,"pendingChild"],[1,2272,143,32],[1,2277,145,4],[1,2278,146,4,"getTypeName"],[1,2292,147,8],[1,2298,22,18],[1,2326,148,4],[1,2328,150,60],[1,2331]],"functionMap":{"names":["<global>","ChildLoadBalancerHandler","ChildLoadBalancerHandler#constructor","ChildPolicyHelper","ChildPolicyHelper#constructor","ChildPolicyHelper#createSubchannel","ChildPolicyHelper#updateState","ChildPolicyHelper#requestReresolution","ChildPolicyHelper#setChild","ChildPolicyHelper#addChannelzChild","ChildPolicyHelper#removeChannelzChild","ChildPolicyHelper#calledByPendingChild","ChildPolicyHelper#calledByCurrentChild","ChildLoadBalancerHandler#configUpdateRequiresNewPolicyInstance","ChildLoadBalancerHandler#updateAddressList","ChildLoadBalancerHandler#exitIdle","ChildLoadBalancerHandler#resetBackoff","ChildLoadBalancerHandler#destroy","ChildLoadBalancerHandler#getTypeName"],"mappings":"AAA;ACsB;ICC;iCCK;YCC;aDG;YEC;aFE;YGC;aHc;YIC;aJM;YKC;aLE;YMC;aNE;YOC;aPE;YQC;aRE;YSC;aTE;SDC;KDC;IYC;KZE;IaO;Kb8B;IcC;KdO;IeC;KfO;IgBC;KhBa;IiBC;KjBE;CDC"},"hasCjsExports":true},"type":"js/module"}]}